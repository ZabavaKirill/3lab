<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Технологии графики в современных играх</title>
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<script src="js/jquery-3.0.0.min.js"></script>
</head>
<body>
	<a href="#" title="Вернуться к началу" class="topbutton">Наверх</a>
	<header>
		<div class="container up">
			<h1>
				Обзор реализаций<br>
				3D-графики при разработке<br>
				компьютерных игр
			</h1>
			<div class="clearfix">
			<nav class="menu">
				<ul>
					<li>
						<a href="index.html">Главная<br></a>
					</li>
					<li>
						<a href="evolution.html">Краткая<br> эволюция игр</a>
					</li>
					<li>
						<a href="#">Технологии графики<br> в 	современных играх</a>
						<ul class="dropdown">
							<li><a href="part1.html">Часть 1</a></li>
							<li><a href="part2.html">Часть 2</a></li>
							<li><a href="part3.html">Часть 3</a></li>
						</ul>
					</li>
					<li>
						<a href="about me.html">Об авторе<br> </a>
					</li>
					</ul>
				</nav>
			</div>
		</div>
	</header>
	<section id="main">
		<div class="container">
			<div class="left-menu">
				<a href="#" class="menu-btn">
					<span></span>
				</a>
				<h3>Содержание</h3>
				<ol class="menu-list">
					<li><a href="#intro">Введение</a></li>
					<li><a href="#translucence">Просвечиваемость</a></li>
					<li><a href="#DoF">Глубина резкости</a></li>
					<li><a href="#HDR">Высокий динамический диапазон</a></li>
					<li><a href="#enlighten">Рассеянное освещение</a></li>
					<li><a href="#motion-blur">Размытие в движении</a></li>
				</ol>
			</div>
			<div class="content">
			<h1>Часть 1:<br>Апофеоз Past-Gen'a </h1>
			<h2 id="intro">Введение</h2>
			<p> Этот период можно считать Ренессансом игровой индустрии. Именно Xbox 360 и Playstation 3 вызвали такой колоссальный скачок в графике, каких не было в предыдущих поколениях и, возможно, уже не будет в следующих. Наверное, благодаря этому <a definition="Past-Gen - past generation, консоли старого, предыдущего поколения." href="term.html#Past-Gen">Past-Gen</a> продержался так долго. Хоть в последнее время уже все понимали, что ему давно пора на пенсию, но графика и по сей день смотрелась весьма неплохо. А во всяких Last of Us — и вовсе шедеврально.</p>
			<p>В результате этой «Эпохи Возрождения» появилось больше графических технологий, чем за всю предыдущую историю игр. Конечно, так произошло в том числе и благодаря затянувшемуся жизненному циклу этих консолей. Но это далеко не основная причина. Да, нынешний past-gen охватил огромный промежуток времени. Так что и в датах появления «экспонатов» из нашего сегодняшнего списка — колоссальный разброс. Одни явились свету практически недавно, другие — буквально сразу же после <a definition="Релиз - освобождение, выпуск, демонстрация, публикация, показ — фильма, книги, пластинки, продукта; также сам выпускаемый объект; окончательная версия программы." href="term.html#Release">релиза</a> этих консолей, а третьи — и вовсе существовали и раньше, но расцвели во всей красе лишь на PS3/X360.</p>
			<h2 id="translucence">Translucence - просвечиваемость</h2>
			<p>Если закрыть фонарик пальцем, можно заметить, что он просвечивает. Возникает интересный парадокс: при обычных условиях ты смотришь на руку — и она ведь непрозрачная. Плотная, матовая. Не просвечивающая. Но если расположить яркий источник света непосредственно за ней, то оказывается, что свет она всё-таки пропускает.
			И так не только с человеческим телом. Воск, матовый пластик, молоко, лист растения… Практически все органические соединения и множество неорганических. То есть, большинство того, что нас окружает.</p>
			<a href="img/planar_translucence.jpg"><img class="right_image" src="img/planar_translucence.jpg" alt="Planar Translucence"></a>
			<p>Этот эффект в графике называется SSS (SubSurface Scattering, подповерхностное рассеяние). И в фильмах он широко используется уже очень давно. Просто потому, что без него лицо персонажа будет выглядеть либо как гипс (если не блестит), либо как эмалированная железка (если блестит). Он повышает реалистичность любой модели, особенно персонажей. Вот только при этом требует немерено <a definition="Процессор - центральная часть компьютера, выполняющая заданные программой преобразования информации и осуществляющая управление всем вычислительным процессом." href="term.html#Processor">процессорного</a> времени. А оттого — для реалтайм-графики просвечиваемость была недоступна до выхода Crysis 1, которой и удалось впервые воссоздать SSS в реалтайме с помощью технологии Thin/Planar (foliage) Translucence.</p>
			<p>Тут, как раз, тот самый случай, когда мощности <a definition="Железо - электронные и механические части компьютера, входящие в состав системы или сети, исключая программное обеспечение и данные." href="term.html#Computer-parts">железа</a> просто однажды позволили. В Crytek не изобретали ничего нового, а лишь взяли на вооружение технологию, которая уже давным-давно используется в кинематографе, да и от стандартного алгоритма освещения отличается лишь одной мелочью. Обычно свет считается только с одной стороны <a definition="Полигон - минимальная поверхность для визуализации. В качестве полигонов обычно применяют треугольники." href="term.html#Polygon">полигона</a>, тут же <a definition="Рендернинг - термин в компьютерной графике, обозначающий процесс получения изображения по модели с помощью компьютерной программы." href="term.html#Rendering">рендеринг</a> осуществляется по тому же самому алгоритму, но освещённость считается не с одной, а с обеих сторон и их результат плюсуется. По сути, ничего нового. Просто в 2 раза больше вычислений на свет. И именно поэтому данная технология раньше не использовалась. В современных играх этот вид просвечиваемости используется повсеместно. Потому что по нынешним меркам двойной или даже тройной расчёт прямого света — и в подмётки не годится прожорливости всяких TressFX'ов. Как ясно из названия, применение этой технологии сильно ограничено. Она подходит лишь для тонких плоских объектов: бумага, ткань, листва, плёнка. Для по-настоящему объёмных вещей — не годится. Однако именно это стало первым шагом к реалистичным лицам персонажей, ведь за ним последовал и второй: Battlefield's 3/«Approximated»/DICE's Translucence</p>
			<div class="two_images clearfix">
			<a href="img/dice_translucence1.png"><img src="img/dice_translucence1.png" alt="Dice Translucence"></a>
			<a href="img/dice_translucence2.png"><img src="img/dice_translucence2.png" alt="Dice Translucence"></a></div>
			<p>У этой просвечиваемости нет собственного названия, поэтому как её только ни называют: approximated (аппроксимированная/приблизительная), DICE's (просвечиваемость от DICE), Battlefield's. Эта просвечиваемость действительно заслуживает внимания, потому что разработчикам удалось получить правдоподобный псевдо-SSS практически по цене предыдущего экспоната. Конечно, эта технология воспроизводит SSS не совсем корректно. Есть ряд артефактов, возникающих при определённых условиях, но рядовой игрок их даже не заметит. Итого, мы имеем практически бесплатный по ресурсам SSS, который работает на по-настоящему объёмных объектах.</p>
			<p>Неудивительно, что со стремительностью сдетонировавшей бомбы эта просвечиваемость разлетелась по всем игровым студиям мира и была реализована во всех существующих <a definition="Игровой движок - базовое программное обеспечение компьютерной игры." href="term.html#Engine">движках</a>. Как ни парадоксально, до сих пор она была задействована всего лишь в нескольких играх.</p>
			<h2 id="DoF">Depth of Field - глубина резкости</h2>
			<p>Так уж решила природа, что человеческий глаз — фокусируется. Научно-технический прогресс ушёл далеко вперёд, и фотоаппараты с видеокамерами уже давным-давно могут снимать абсолютно резкое изображение. Вот только оно никому не нужно.
			DoF придаёт картинке «киношности». Он позволяет акцентировать внимание зрителя на наиболее важном объекте. Расфокус настолько необходим в кино, что даже если его не было в оригинальном видео — его искусственно туда добавляют. Попытки воссоздать Depth of Field в играх начались давно, до прихода нынешнего <a definition="Next-Gen - next generation, новое поколение консолей или технологий." href="term.html#Next-Gen">next-gen'а</a>. использовались следующие технологии:
			</p>
			<p><b>Размытие по карте глубины.</b><br>Суть проста: Есть исходная (резкая) картинка и к ней есть карта глубины. Берём первую — и размываем её по второй. Где на карте глубины белое — там максимум размытия, где чёрное — там его нет (фокус). Как говорится, всё гениальное — просто. Улучшая различные аспекты этого метода, разработчикам в итоге удалось сделать довольно убедительный расфокус.
			Вот только у него есть 2 неустранимые проблемы:
			<ul>
				<li>прозрачные объекты размываются некорректно, т.к. каждый <a definition="Пиксель - наименьший логический элемент двумерного цифрового изображения в растровой графике.Представляет собой неделимый объект прямоугольной или круглой формы, характеризуемый определённым цветом." href="term.html#Pixel">пиксель</a> имеет только одну позицию по глубине.</li>
				<li>на границах объектов размытие тоже получается некорректным: либо цвет переднего плана «заезжает» на фон, либо наоборот.</li>
			</ul>
			</p>
			<a href="img/bokeh.jpg"><img src="img/bokeh.jpg" alt="Bokeh"></a>
			<p><b>Bokeh.</b><br>Эффект Боке — такое хитрое размытие, после которого фон становится не просто мутным, а приобретает форму ярких кружочков/многоугольников. В нём две оговорённые выше проблемы частично решены. Плюс к тому, качество размытия — тоже выше.</p>
			<h2 id="HDR">HDR - High Dynamic Range - <br> высокий динамический диапазон </h2>
			<p>В природе нет такого понятия, как «максимально яркий свет». Свет может быть любой яркости: от ноля и до бесконечности. Когда мы видим какой-то цвет как абсолютно белый — это лишь значит, что в данный момент наш глаз выбрал эту яркость в качестве максимальной, чтобы разглядеть какие-то детали. Так обстоят дела в природе. В играх же есть <a definition="Текстура - растровое изображение, накладываемое на поверхность полигональной модели для придания ей цвета, окраски или иллюзии рельефа." href="term.html#Texture">текстуры</a> - обычные картинки в формате jpg/png/tga. У них есть чёрное и белое значение, и некоторое количество оттенков между ними. Всё. Давайте представим, что у нас есть некоторая яркая текстура и нам надо понизить её яркость: </p>
			<div class="set_of_images clearfix">
				<figure class="image">
					<a href="img/hdr1.jpg"><img src="img/hdr1.jpg" alt="Исходное изображение"></a>
					<figcaption>Исходное изображение</figcaption>
				</figure>
				<figure class="image">
					<a href="img/hdr2.jpg"><img src="img/hdr2.jpg" alt="Желаемый результат"></a>
					<figcaption>Желаемый результат</figcaption>
				</figure>
				<figure class="image">
					<a href="img/hdr3.jpg"><img src="img/hdr3.jpg" alt="Полученный результат"></a>
					<figcaption>Полученный результат</figcaption>
				</figure>
			</div>
			<p>Мы получим данный результат, потому что в картинке максимально яркий — это белый. А всё, что ярче него — обрезано до него и после нашей обработки превратится в сплошной серый вместо того, чтобы «открыть» нам те детали, которые находятся в пересвеченной области.</p>
			<p>HDR расширяет диапазон возможных цветов. С ней — они могут быть ярче единицы. Если отрисовать такую картинку «как есть», то эти «сверх-яркие» цвета будут выглядеть как максимальный белый (потому что монитор не может выдать цвет ярче), но на самом деле их фактические значения не обрежутся. Поэтому с HDR картинка выглядит гораздо корректнее. </p>
			<a href="img/hdr.jpg"><img src="img/hdr.jpg" alt="HDR"></a>
			<p>Помимо очевидного повышения реализма «в одно включение» эта технология также позволяет изменять яркость картинки на стадии <a definition="Пост-эффект - какой-либо визуальный эффект, накладываемый поверх видео-изображения." href="term.html#Post-effect">пост-эффектов</a>. То есть, с её помощью можно сделать эффект смены экспозиции (также известный как Tone Mapping) - это когда картинка плавно меняет яркость при переходе из тёмного помещения в светлое или наоборот. При наличии HDR <a definition="Гейм-девелопер - разработчик программного обеспечения, специализирующийся на разработке видеоигр — процессе и связанных с ним дисциплинах из области создания видеоигр." href="term.html#Game-Developer">гейм-девелопер</a> ничем не ограничен в пост-обработке, и может сделать картинку ещё более выразительной (это называется цветокоррекцией).</p>
			<h2 id="enlighten">Enlighten - рассеянное освещение</h2>
			<a href="img/enlighten.jpg"><img src="img/enlighten.jpg" alt="Enlighten"></a>
			<p>В 2007 году никому не известная компания Geomerics опубликовала <a definition="Трейлер - небольшой видеоролик, состоящий из кратких и обычно наиболее зрелищных фрагментов компьютерной игры, используемый для анонсирования или рекламы этой игры." href="term.html#Trailer">трейлер</a>, демонстрирующий работу технологии Enlighten, реализующей рассеянное освещение. Эта невероятная по тем временам технология поразила умы многих, однако на момент анонса железо всё ещё не позволяло считать такое в реалтайме с комфортным для игры <a definition="FPS - от английского frames per second - кадры в секунду. Это количество сменяемых кадров за единицу времени в компьютерных играх, телевидении и кинематографе." href="term.html#FPS">FPS</a>. Разработчики не забросили свою затею и с 2008 года с нарастающим энтузиазмом показывали всё новые и новые демонстрации. </p>
			<p>В итоге никто и не заметил, как эта технология стала <a definition="Мейнстрим - преобладающее направление в какой-либо области для определённого отрезка времени." href="term.html#Mainstream">мейнстримом</a> и по факту стала стандартом. Сейчас все основные игровые движки используют Enlighten.</p>
			<h2 id="motion-blur">Motion Blur - размытие в движении</h2>
			<a href="img/blur.jpg"><img src="img/blur.jpg" alt="Morion Blur"></a>
			<p>Motion Blur или размытие в движении, как и DoF добавляет реализма. И, опять же, как и DoF, для хорошего качества исполнения требует немало ресурсов. Кроме того, в отличие от расфокуса, этот эффект необходим: без него видео будет казаться дёрганным. Вообще, в графике есть несколько способов рендеринга Motion Blur. Но конкретно в играх практически всегда используется <b>Multiple Exposure.</b> Принцип метода:</p>
			<p>Каждый кадр рендерится не один раз в один момент времени, а много-много раз, которые равномерно распределены по всей длительности кадра.
			Потом все эти экспозиции смешиваются вместе с разной степенью интенсивности.
			Получается, что вместо одной фазы движения мы засняли несколько, которые все вместе формируют нужный нам эффект размытости. Очевидно, что для качественного результата этих самых экспозиций должно быть как можно больше. Иначе они будут видны по отдельности, и картинка развалится на ступенчатые фазы. Кроме того, не надо забывать, что каждая такая экспозиция — это, по сути, отдельный расчёт кадра кадр. То есть, если у нас 4 экспозиции, та же самая картинка будет считаться в 4 раза дольше. Если 8 — то в 8, и т.д.
			</p>
			<p>Может показаться, что этот метод плох из-за своей неповоротливости. Но на самом деле нынешнее железо вполне в состоянии пересчитывать кадр по 2, 4, 8 и больше раз. А при большом количестве «шажков» — этому методу нет равных. потому что считается он самым «дубовым» методом, и оттого — самым правильным. Если не считать этих «ступенек» — с ним в принципе невозможны артефакты, которые есть у других методов.</p>
			<p>Другой способ — <b>векторный Motion blur</b>. Принцип работы: картинка рендерится только один раз. Но помимо неё — «невидимо» для игрока также считается специальная карта векторов. Она показывает, в каком направлении двигается каждый пиксель на отрендеренной картинке. После чего основная картинка «размазывается» в соответствии с направлениями (векторами) со второй карты. Прелесть этого метода в том, что на нынешнем железе его уже можно использовать, и при этом он выдаст гладкую картинку, без фаз движения и у него нет никакого «количества экспозиций», так что качество размытия всегда безупречное, не надо жертвовать ради него производительностью.</p>
			<p>Но есть и минусы. Самый серьёзный из них — это специфические артефакты. К примеру, если один объект движется очень быстро перед вторым. Игра считает картинку только один раз, в какой-то одной фазе. И в этой фазе — движущаяся часть закрыла неподвижную. Алгоритму просто неоткуда взять информацию о том, что должно быть за этой частью. В результате неподвижный фон тоже размывается.</p>
			Именно из-за них в большинстве игр используется только метод множественной экспозиции. Правда, у векторного блюра существует один подвид, который довольно широко используется в играх. Это <b>Zoom Blur</b> или <b>Radial Blur</b> – в нём векторы размытия направлены от центра кадра к краям.
		</div>
	</div>
	</section>
	
	<footer>	
	<div class="container">
		&copy; 2020г <a href="mailto:zabavakirill2000@yandex.ru">Забава Кирилл Николаевич</a> | <a href="map.html">Карта сайта</a> | <a href="term.html">Справочник</a>  | <a href="source.html">Список источников</a>
	</div>
</footer>
	<script type="text/javascript">
		$('.menu-btn').on('click', function(e) {
			e.preventDefault();
			$('.left-menu').toggleClass('menu-active');
			$('.content').toggleClass('content-active');
			$('.up').toggleClass('content-active');
		})
		$('.menu-list').on('click', function() {
			$('.left-menu').toggleClass('menu-active');
			$('.content').toggleClass('content-active');
			$('.up').toggleClass('content-active');
		})
	</script>
</body>
</html>